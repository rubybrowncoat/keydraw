(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{320:function(t,e,r){var content=r(324);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(43).default)("3f7162f7",content,!0,{sourceMap:!1})},321:function(t,e,r){var content=r(327);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(43).default)("21178f1c",content,!0,{sourceMap:!1})},322:function(t,e,r){var content=r(329);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(43).default)("73ce4faf",content,!0,{sourceMap:!1})},323:function(t,e,r){"use strict";var n=r(320);r.n(n).a},324:function(t,e,r){(t.exports=r(42)(!1)).push([t.i,".action-bar[data-v-63de6628]{position:fixed;padding:20px;bottom:0;left:50%;transform:translateX(-50%);vertical-align:middle;text-align:center;text-transform:uppercase;font-size:22px;border-radius:10px 10px 0 0;border-width:1px 1px 0;border-style:solid}",""])},325:function(t,e,r){"use strict";r(27);var n={props:{kind:{type:String,default:"keydraw"}}},o=(r(323),r(17)),component=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"action-bar"},["keydraw"===t.kind?r("div",{staticClass:"menu active"},[t._m(0),t._v(" "),t._m(1)]):t._e(),t._v(" "),"artefact"===t.kind?r("div",{staticClass:"menu active"},[t._m(2)]):t._e(),t._v(" "),"commune"===t.kind?r("div",{staticClass:"menu active"},[t._m(3)]):t._e(),t._v(" "),"generic"===t.kind?r("div",{staticClass:"menu active"},[t._m(4)]):t._e()])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"menuItem"},[e("span",{staticClass:"label"},[this._v("⮐")]),this._v(" "),e("em",[this._v(" ARTEFACT ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"menuItem"},[e("span",{staticClass:"label"},[this._v("\\")]),this._v(" "),e("em",[this._v(" COMMUNE ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"menuItem"},[e("span",{staticClass:"label"},[this._v("⌫")]),this._v("\n      EDIT\n    ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"menuItem"},[e("span",{staticClass:"label"},[this._v("⌫")]),this._v("\n      GO ALONE\n    ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"menuItem"},[e("span",{staticClass:"label"},[this._v("⌫")]),this._v("\n      BACK\n    ")])}],!1,null,"63de6628",null);e.a=component.exports},326:function(t,e,r){"use strict";var n=r(321);r.n(n).a},327:function(t,e,r){(t.exports=r(42)(!1)).push([t.i,".instructions-container[data-v-735d6dd4]{position:relative;width:100%;max-width:1300px;padding:0 20px;top:20px;left:50%;transform:translateX(-50%);vertical-align:middle;display:flex;justify-content:space-between;text-transform:uppercase;font-size:22px}.instructions-container .name[data-v-735d6dd4]{float:left;padding:5px 10px;height:33px;border-radius:5px}.instructions-container .copyright[data-v-735d6dd4]{margin-left:15px}",""])},328:function(t,e,r){"use strict";var n=r(322);r.n(n).a},329:function(t,e,r){(t.exports=r(42)(!1)).push([t.i,".base-canvas[data-v-c7df32dc]{position:relative;margin-top:50px;margin-bottom:100px}.display-grid[data-v-c7df32dc]{position:relative;left:50%;transform:translateX(-50%);border-width:1px;border-style:solid;border-top:0;border-left:0}.hide .display-grid[data-v-c7df32dc]{border-width:0;background:transparent}.display-grid .active-key[data-v-c7df32dc]{position:absolute;z-index:-1}.keyboard[data-v-c7df32dc]{display:flex;top:0;border-style:solid;border-width:0 1px 1px 0;box-sizing:border-box;flex-wrap:wrap}[class*=key-][data-v-c7df32dc]{display:inline-block;vertical-align:top;border-style:solid;border-width:1px 0 0 1px;opacity:1!important;margin:0}[class*=key-] span[data-v-c7df32dc]{font-size:20px;display:block;text-align:center;margin:0!important;padding:0!important}[class*=key-].medium span[data-v-c7df32dc]{font-size:14px}[class*=key-].small span[data-v-c7df32dc]{font-size:11px}[class*=key-].tiny span[data-v-c7df32dc]{font-size:0}.hide [class*=key-][data-v-c7df32dc]{border-width:0}",""])},330:function(t,e,r){"use strict";r(44),r(23),r(14),r(5),r(32);var n=r(10),o=r(27);function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}var h={props:["artefact","commune"],computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(source,!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(source).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(o.c)("color",["currentName"]),{},Object(o.c)("theme",["currentTheme"]),{},Object(o.c)("grid",["keyboardWidth","keyboardHeight","gridWidth","gridHeight","actives"]))},l=(r(326),r(17)),component=Object(l.a)(h,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"instructions-container"},[r("span",{staticClass:"name"},[t._v("\n    Keydraw\n    "),t.commune?r("span",{staticClass:"txtLabel"},[t._v("commune")]):t.artefact?r("span",{staticClass:"txtLabel"},[t._v("artefact")]):t._e()]),t._v(" "),t.artefact?t._e():r("div",{staticClass:"menu active"},[r("span",{staticClass:"menuItem"},[r("span",{staticClass:"label"},[r("fa",{attrs:{icon:["fas","arrows-alt"]}})],1),t._v("\n      MOVE\n    ")]),t._v(" "),r("span",{staticClass:"menuItem"},[r("span",{staticClass:"label"},[r("fa",{attrs:{icon:["fas","keyboard"]}})],1),t._v("\n      TOGGLE\n    ")]),t._v(" "),t.commune?t._e():r("span",{staticClass:"menuItem"},[r("span",{staticClass:"label"},[t._v("\n        ⌫\n      ")]),t._v("\n      CLEAR\n    ")]),t._v(" "),r("span",{staticClass:"menuItem"},[r("span",{staticClass:"label"},[r("fa",{attrs:{icon:["fas","space-shuttle"]}})],1),t._v("\n      COLOR "),r("span",{class:["colorLabel",t.currentName]})]),t._v(" "),r("span",{class:["menuItem",{lock:t.commune}]},[t.commune?r("span",{staticClass:"label"},[r("fa",{attrs:{icon:["fas","lock"]}})],1):r("span",{staticClass:"label"},[t._v("\n        ⇧ "),r("fa",{attrs:{icon:["fas","arrows-alt"]}})],1),t._v("\n      SIZE "),r("span",{staticClass:"txtLabel"},[t._v(t._s(t.gridWidth)+"×"+t._s(t.gridHeight))])]),t._v(" "),r("span",{class:["menuItem",{lock:t.commune}]},[t.commune?r("span",{staticClass:"label"},[r("fa",{attrs:{icon:["fas","lock"]}})],1):r("span",{staticClass:"label"},[t._v("\n        I/O\n      ")]),t._v("\n      THEME "),r("span",{staticClass:"txtLabel"},[t._v(t._s(t.currentTheme))])])]),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:t.artefact,expression:"artefact"}],staticClass:"menu"}),t._v(" "),t._m(0)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"copyright"},[this._v("\n    © 2018 "),e("a",{attrs:{href:"http://pumo.mp"}},[this._v("pumo.mp")])])}],!1,null,"735d6dd4",null);e.a=component.exports},331:function(t,e,r){"use strict";r(44),r(23),r(14),r(5),r(32);var n=r(10),o=r(27),filter=r(335),c=r(334),h=r(164),l=void 0;function d(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}var f={props:["hidden","keySize","keyboardLeft","keyboardTop"],data:function(){return{keyboard:h.a,windowWidth:window.innerWidth}},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(source,!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):d(source).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(o.c)("grid",["keyboardWidth","keyboardHeight","gridWidth","gridHeight","actives"]),{limitedKeySize:function(){return Math.min(Math.floor((this.windowWidth-50)/this.gridWidth),this.keySize)},gridActives:function(){var t=this;return Object(filter.a)(this.actives,(function(e){return e.top<t.gridHeight&&e.left<t.gridWidth}))}}),methods:{keyResize:Object(c.a)((function(){l.windowWidth=window.innerWidth}),250)},beforeMount:function(){window.addEventListener("resize",this.keyResize)},beforeDestroy:function(){window.removeEventListener("resize",this.keyResize)}},v=(r(328),r(17)),component=Object(v.a)(f,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"base-canvas",class:{hide:t.hidden}},[r("div",{ref:"grid",staticClass:"display-grid",style:{backgroundSize:t.limitedKeySize+"px "+t.limitedKeySize+"px",width:t.gridWidth*t.limitedKeySize+"px",height:t.gridHeight*t.limitedKeySize+"px"}},[t._l(t.gridActives,(function(e,n){return r("div",{key:n,class:["active-key",e.status],style:{top:e.top*t.limitedKeySize+"px",left:e.left*t.limitedKeySize+"px",width:t.limitedKeySize+"px",height:t.limitedKeySize+"px"}})})),t._v(" "),void 0!==t.keyboardLeft&&void 0!==t.keyboardTop?r("div",{directives:[{name:"show",rawName:"v-show",value:!t.hidden,expression:"!hidden"}],staticClass:"keyboard",style:{transform:"translate3d(+"+t.limitedKeySize*t.keyboardLeft+"px, +"+t.limitedKeySize*t.keyboardTop+"px, 0)",width:"calc("+t.limitedKeySize*t.keyboardWidth+"px + 1px)"}},t._l(t.keyboard,(function(e){var code=e.code,n=e.key;return r("div",{key:code,class:["key-"+code,t.limitedKeySize<=24?"medium":null,t.limitedKeySize<=18?"small":null,t.limitedKeySize<=12?"tiny":null],style:{minWidth:t.limitedKeySize+"px",width:t.limitedKeySize+"px",minHeight:t.limitedKeySize+"px",height:t.limitedKeySize+"px",lineHeight:t.limitedKeySize+"px"}},[r("span",[t._v(t._s(n))])])})),0):t._e()],2)])}),[],!1,null,"c7df32dc",null);e.a=component.exports},334:function(t,e,r){"use strict";var n=r(12),o=r(8),c=function(){return o.a.Date.now()},h=r(165),l="Expected a function",d=Math.max,f=Math.min;var v=function(t,e,r){var o,v,m,y,k,w,O=0,x=!1,z=!1,_=!0;if("function"!=typeof t)throw new TypeError(l);function C(time){var e=o,r=v;return o=v=void 0,O=time,y=t.apply(r,e)}function S(time){var t=time-w;return void 0===w||t>=e||t<0||z&&time-O>=m}function j(){var time=c();if(S(time))return T(time);k=setTimeout(j,function(time){var t=e-(time-w);return z?f(t,m-(time-O)):t}(time))}function T(time){return k=void 0,_&&o?C(time):(o=v=void 0,y)}function E(){var time=c(),t=S(time);if(o=arguments,v=this,w=time,t){if(void 0===k)return function(time){return O=time,k=setTimeout(j,e),x?C(time):y}(w);if(z)return clearTimeout(k),k=setTimeout(j,e),C(w)}return void 0===k&&(k=setTimeout(j,e)),y}return e=Object(h.a)(e)||0,Object(n.a)(r)&&(x=!!r.leading,m=(z="maxWait"in r)?d(Object(h.a)(r.maxWait)||0,e):m,_="trailing"in r?!!r.trailing:_),E.cancel=function(){void 0!==k&&clearTimeout(k),O=0,o=w=v=k=void 0},E.flush=function(){return void 0===k?y:T(c())},E},m="Expected a function";e.a=function(t,e,r){var o=!0,c=!0;if("function"!=typeof t)throw new TypeError(m);return Object(n.a)(r)&&(o="leading"in r?!!r.leading:o,c="trailing"in r?!!r.trailing:c),v(t,e,{leading:o,maxWait:e,trailing:c})}},335:function(t,e,r){"use strict";var n=r(166),o=r(74);var c=function(t,e){var r=[];return Object(o.a)(t,(function(t,n,o){e(t,n,o)&&r.push(t)})),r},h=r(31),l=r(3);e.a=function(t,e){return(Object(l.a)(t)?n.a:c)(t,Object(h.a)(e,3))}},341:function(t,e,r){r(217)("Uint8",1,(function(t){return function(data,e,r){return t(this,data,e,r)}}))},342:function(t,e,r){"use strict";r.r(e);r(44),r(23),r(14),r(5),r(32),r(65);var n=r(4),o=r(10),c=r(0),h=r(27),l=r(64),d=r(330),f=r(331),v=r(325),m=(r(66),r(71)),y=r(53);r(167),r(141),r(142);function k(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function O(t,e,r){return e&&w(t.prototype,e),r&&w(t,r),t}var x=r(119),z=r(168),_=r(54),C=Math.ceil,S=Math.max;var j=function(t,e,r){e=(r?Object(z.a)(t,e,r):void 0===e)?1:S(Object(_.a)(e),0);var n=null==t?0:t.length;if(!n||e<1)return[];for(var o=0,c=0,h=Array(C(n/e));o<n;)h[c++]=Object(x.a)(t,o,o+=e);return h};var T=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(!e(t[r],r,t))return!1;return!0},E=r(74);var A=function(t,e){var r=!0;return Object(E.a)(t,(function(t,n,o){return r=!!e(t,n,o)})),r},W=r(31),I=r(3);var P=function(t,e,r){var n=Object(I.a)(t)?T:A;return r&&Object(z.a)(t,e,r)&&(e=void 0),n(t,Object(W.a)(e,3))},K=r(98),M=Object(K.a)("tile-"),L=function(){function t(e,r,n,o){k(this,t),this.tileSize=r,this.occupancy=this.tileSize+1,this.width=n,this.height=o,this.buffer=e,this.tiles=[],this.ordered=[],this.initialize()}return O(t,[{key:"initialize",value:function(){var t=new ImageData(this.buffer,this.width,this.height),e=document.createElement("canvas"),r=e.getContext("2d");e.width=this.width,e.height=this.height,r.putImageData(t,0,0),console.log("tileSize",this.tileSize);for(var n=0;n<this.width/this.occupancy;n+=1)for(var o=0;o<this.height/this.occupancy;o+=1){1;var c=n*this.occupancy,h=o*this.occupancy,l=r.getImageData(c,h,this.tileSize,this.tileSize).data,d=j(l,4);if(!l.every((function(t,e,r){return 255===t})))if(!(r.getImageData(c+this.tileSize,h,1,1).data.toString()!=new Uint8ClampedArray([255,255,255,255]).toString())){var f=this.edges(d),v=Object(y.a)(f,4),k=v[0],w=v[1],O=v[2],x=v[3],z="F";this.edgeCompare.apply(this,Object(m.a)(f))?z="X":this.edgeCompare(O,k)&&this.edgeCompare(w,x)?z="I":this.edgeCompare(O,k)||this.edgeCompare(w,x)?z="T":this.edgeCompareReversed(O,x)&&this.edgeCompareReversed(O,k)?z="S":(this.edgeCompareReversed(O,x)||this.edgeCompareReversed(k,w))&&(z="L");var _=r.getImageData(c,h+this.tileSize,this.tileSize+1,1).data,C=j(_,4).map((function(t){return t.every((function(t){return 255===t}))?0:1})).join(""),S=parseInt(C,2)*(.99/(Math.pow(this.tileSize+1,2)-1))+.01,T={name:M.generate(),bitmap:l,processed:d,symmetry:z,weight:S};this.tiles.push(T),this.ordered.push(T.name)}}}},{key:"edge",value:function(t,e){var r=this,n=Object(y.a)(t,2),o=n[0],c=n[1];return o?e.filter((function(t,e){return e%r.tileSize==(.5+o/2)*(r.tileSize-1)})):c?e.filter((function(t,e){return e<Math.pow(r.tileSize,(c+3)/2)&&e>=.5*r.tileSize*(r.tileSize-1)*(c+1)})):void 0}},{key:"edges",value:function(t){return[this.edge([1,0],t),this.edge([0,-1],t),this.edge([-1,0],t),this.edge([0,1],t)]}},{key:"edgeCompare",value:function(head){for(var t=head.toString(),e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return P(r,(function(e){return e.toString()==t}))}},{key:"edgeCompareReversed",value:function(t,e){return e.reverse(),t.toString()==e.toString()}}]),t}();r(341),r(94);var H=function(t,e){for(var r,n=-1,o=t.length;++n<o;){var c=e(t[n]);void 0!==c&&(r=void 0===r?c:r+c)}return r},R=r(81);var D=function(t){return t&&t.length?H(t,R.a):0},$=r(192);var N=function(t){return"function"==typeof t?t:R.a};var B=function(t,e){return(Object(I.a)(t)?$.a:E.a)(t,N(e))},G=function(object,t){var e=null;for(var r in object)object.hasOwnProperty(r)&&object[r]<=t&&(e=r);return e},U=function(){function t(e,r,n){k(this,t),this.initialized=!1,this.complete=!1,this.wave=[],this.changes=null,this.stationary=[],this.propagator=[],this.width=e,this.height=r,this.tileset=n,this.tiles=n.tiles.length,this.tilesize=n.tileSize,this.black=!1,this.periodic=!1,this.actuated=0,this.actuatedTiles=[],this.initialize()}return O(t,[{key:"edge",value:function(t,e){var r=this,n=Object(y.a)(t,2),o=n[0],c=n[1];return o?e.filter((function(t,e){return e%r.tilesize==(.5+o/2)*(r.tilesize-1)})):c?e.filter((function(t,e){return e<Math.pow(r.tilesize,(c+3)/2)&&e>=.5*r.tilesize*(r.tilesize-1)*(c+1)})):void 0}},{key:"clockwise",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e%4;if(!r)return t;for(var n=t.length,o=new t.constructor(n),c=this.tilesize,h=this.tilesize,l=0;l<this.length;l+=1){var d=l%h,f=(l-d)/h;o[l]=this.buffer[(h-1)*c-d*c+f]}return this.clockwise(o,r-1)}},{key:"counterClockwise",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e%4;if(!r)return t;for(var n=t.length,o=new t.constructor(n),c=this.tilesize,h=this.tilesize,l=0;l<n;l+=1){var d=l%h,f=(l-d)/h;o[l]=t[c-1-f+d*h]}return this.counterClockwise(o,r-1)}},{key:"initialize",value:function(){var t,e,r=this,n=[],o={};B(this.tileset.tiles,(function(c){switch(c.symmetry){case"I":case"S":e=2,t=function(i){return 1-i};break;case"F":case"L":case"T":e=4,t=function(i){return(i+1)%4};break;case"X":default:e=1,t=function(i){return i}}r.actuated=n.length,o[c.name]=r.actuated;for(var h=0;h<e;h+=1){var l=[r.actuated+h,r.actuated+t(h),r.actuated+t(t(h)),r.actuated+t(t(t(h)))];n.push(l),r.stationary.push(c.weight||1)}r.actuatedTiles.push(c.processed);for(var d=1;d<e;d+=1){var f=r.counterClockwise(r.actuatedTiles[r.actuated+d-1]);r.actuatedTiles.push(f)}})),this.actuated=n.length,this.propagator=new Array(4);for(var c=0;c<4;c+=1){this.propagator[c]=new Array(this.actuated);for(var h=0;h<this.actuated;h+=1){this.propagator[c][h]=new Array(this.actuated);for(var l=0;l<this.actuated;l+=1)this.propagator[c][h][l]=!1}}this.wave=new Array(this.width),this.changes=new Array(this.width);for(var d=0;d<this.width;d+=1){this.wave[d]=new Array(this.height),this.changes[d]=new Array(this.height);for(var f=0;f<this.height;f+=1)this.wave[d][f]=new Array(this.actuated)}this.neighbors=[],this.actuatedTiles.forEach((function(t,e){var n=r.edge([1,0],t),c=G(o,e),h=e-o[c];r.actuatedTiles.forEach((function(t,e){var l=r.edge([-1,0],t),d=G(o,e),f=e-o[d];n.toString()==l.toString()&&r.neighbors.push({left:c+(h?" "+h:""),right:d+(f?" "+f:"")})}))})),B(this.neighbors,(function(t){var e=t.left.split(" ").filter((function(t){return t.length})),c=t.right.split(" ").filter((function(t){return t.length})),h=o[e[0]],l=1==e.length?0:parseInt(e[1],10),d=o[c[0]],f=1==c.length?0:parseInt(c[1],10),v=n[h][l],m=n[v][1],y=n[d][f],k=n[y][1];r.propagator[0][y][v]=!0,r.propagator[1][k][m]=!0}));for(var v=0;v<this.actuated;v+=1)for(var m=0;m<this.actuated;m+=1)this.propagator[2][v][m]=this.propagator[0][m][v],this.propagator[3][v][m]=this.propagator[1][m][v]}},{key:"isComplete",value:function(){return this.complete}},{key:"onBoundary",value:function(t,e){return!this.periodic&&(t<0||e<0||t>=this.width||e>=this.height)}},{key:"clear",value:function(){for(var t=0;t<this.width;t+=1)for(var e=0;e<this.height;e+=1){for(var r=0;r<this.actuated;r+=1)this.wave[t][e][r]=!0;this.changes[t][e]=!1}this.initialized=!0,this.complete=!1}},{key:"singleIteration",value:function(t){var e=this.observe(t);if(null!==e)return this.complete=e,!!e;for(;this.propagate(););return null}},{key:"iterate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random;this.initialized||this.clear();for(var r=0;r<t||0===t;r+=1){var n=this.singleIteration(e);if(null!==n)return!!n}return!0}},{key:"generate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random;for(this.clear();;){var e=this.singleIteration(t);if(null!==e)return!!e}}},{key:"observe",value:function(t){for(var e=-1,r=-1,n=1e3,o=new Array(this.actuated),c=0;c<this.width;c+=1)for(var h=this.wave[c],l=0;l<this.height;l+=1)if(!this.onBoundary(c,l)){for(var d=h[l],f=0,v=0,m=1e-6*t(),y=0;y<this.actuated;y+=1)o[y]=d[y]?this.stationary[y]:0,f+=o[y];if(0===f)return console.log("bad sum"),!1;for(var k=0;k<this.actuated;k+=1)o[k]/=f;for(var w=0;w<o.length;w+=1){var O=o[w];O>0&&(v+=-O*Math.log(O))}v>0&&v+m<n&&(n=v+m,e=c,r=l)}if(-1===e&&-1===r)return console.log("bad minimums"),!0;for(var x=0;x<this.actuated;x+=1){var z=this.wave[e][r];o[x]=z[x]?this.stationary[x]:0}for(var _=function(t,e){for(var r=D(t),n=t.map((function(t,e,n){return r?t/r:1/n.length})),o=0,c=0;o<n.length;){if(e<=(c+=n[o]))return o;o+=1}return 0}(o,t()),C=0;C<this.actuated;C+=1){this.wave[e][r][C]=C===_}return this.changes[e][r]=!0,null}},{key:"propagate",value:function(){for(var t=!1,e=0;e<this.width;e+=1)for(var r=0;r<this.height;r+=1)for(var n=0;n<4;n+=1){var o=e,c=r;if(0===n)if(0===e){if(!this.periodic)continue;o=this.width-1}else o=e-1;else if(1===n)if(r===this.height-1){if(!this.periodic)continue;c=0}else c=r+1;else if(2===n)if(e===this.width-1){if(!this.periodic)continue;o=0}else o=e+1;else if(0===r){if(!this.periodic)continue;c=this.height-1}else c=r-1;if(this.changes[o][c])for(var h=this.wave[o][c],l=this.wave[e][r],d=0;d<this.actuated;d+=1)if(l[d]){for(var f=this.propagator[n][d],v=!1,m=0;m<this.actuated&&!v;m+=1)h[m]&&(v=f[m]);v||(l[d]=!1,this.changes[e][r]=!0,t=!0)}}return t}},{key:"graphicsComplete",value:function(t){var e,r,n,o,c,h,l;for(n=0;n<this.width;n++)for(o=0;o<this.height;o++)for(this.wave[n][o],h=0;h<this.tilesize;h++)for(c=0;c<this.tilesize;c++)for(e=4*(n*this.tilesize+c+(o*this.tilesize+h)*this.width*this.tilesize),l=0;l<this.actuated;l++)this.wave[n][o][l]&&(r=this.actuatedTiles[l][h*this.tilesize+c],t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3])}},{key:"graphicsIncomplete",value:function(t,e){for(var r=this,n=0;n<this.width;n+=1)for(var o=function(o){var c=r.wave[n][o];if(!r.changes[n][o])return"continue";for(var h=c.reduce((function(t,e,n){return e&&(t[0]+=1,t[1]+=r.stationary[n]),t}),[0,0]),l=Object(y.a)(h,2),d=l[0],f=l[1],v=function(h){for(var l=function(l){var v=4*(n*r.tilesize+l+(o*r.tilesize+h)*r.width*r.tilesize);if(e&&d===r.actuated&&4===e.length)t.set(e,v);else{var m=r.actuatedTiles.reduce((function(t,e,n){if(c[n]){var o=e[h*r.tilesize+l],d=r.stationary[n];t[0]+=o[0]*d/f,t[1]+=o[1]*d/f,t[2]+=o[2]*d/f,t[3]+=o[3]*d/f}return t}),[0,0,0,0]);t.set(m,v)}},v=0;v<r.tilesize;v+=1)l(v)},m=0;m<r.tilesize;m+=1)v(m)},c=0;c<this.height;c+=1)o(c)}},{key:"graphics",value:function(t,e){return t=t||new Uint8Array(this.width*this.tilesize*this.height*this.tilesize*4),this.isComplete()?this.graphicsComplete(t):this.graphicsIncomplete(t,e),t}}]),t}(),X=r(164);r(16);function F(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function J(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?F(source,!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):F(source).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var V,Z,Q={transition:function(t,e){return e?"slide-right":"slide-left"},data:function(){return{keySize:30,keyboardPosition:[0,0],hidden:!1,generator:null,isMapActive:!1,isMapRunning:!0,mapRunner:null}},components:{instructions:d.a,"base-canvas":f.a,"action-bar":v.a},computed:J({},Object(h.c)("color",["currentName"]),{},Object(h.c)("theme",["currentTheme","exportTheme"]),{},Object(h.c)("grid",["actives","gridWidth","gridHeight","keyboardWidth","keyboardHeight","exportSize","exportActives","exportBuffer"]),{},Object(h.c)("keytsh",["keytshCollapsed"]),{},Object(h.c)("map",["tileSize","mapWidth","mapHeight"]),{keyboardLeft:function(){return this.keyboardPosition[0]},keyboardTop:function(){return this.keyboardPosition[1]}}),methods:J({},Object(h.b)("color",["nextColor","previousColor"]),{},Object(h.b)("theme",["nextTheme","previousTheme"]),{},Object(h.b)("grid",["incrementWidth","decrementWidth","incrementHeight","decrementHeight","clearActives","toggleActive"]),{},Object(h.b)("keytsh",["toggleKeytshCollapse"]),{},Object(h.b)("map",["increaseTileSize","decreaseTileSize"]),{toggleGrid:function(t){var e=this.keyboardLeft+t%this.keyboardWidth,r=this.keyboardTop+~~(t/this.keyboardWidth);this.toggleActive({position:"".concat(e,"x").concat(r),name:this.currentName})},checkKeyboard:function(){this.keyboardLeft>=this.gridWidth&&c.a.set(this.keyboardPosition,0,this.gridWidth-this.keyboardWidth),this.keyboardTop>=this.gridHeight&&c.a.set(this.keyboardPosition,1,this.gridHeight-this.keyboardHeight)},doExport:(Z=Object(n.a)(regeneratorRuntime.mark((function t(){var content,e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return content="".concat(this.exportTheme,";").concat(this.exportSize,";").concat(this.exportActives),t.next=3,this.$axios.$post("saved_boards",{content:content});case 3:(e=t.sent).url&&this.$router.push("/artefact/".concat(e.url));case 5:case"end":return t.stop()}}),t,this)}))),function(){return Z.apply(this,arguments)}),doShared:(V=Object(n.a)(regeneratorRuntime.mark((function t(){var content,e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return content="".concat(this.exportTheme,";").concat(this.exportSize),t.next=3,this.$axios.$post("shared_boards",{content:content});case 3:(e=t.sent).url&&this.$router.push("/commune/".concat(e.url));case 5:case"end":return t.stop()}}),t,this)}))),function(){return V.apply(this,arguments)}),keyOperation:function(t){var e=this;if(this.keytshCollapsed)switch(t.preventDefault(),t.key){case"ArrowLeft":this.hidden||(t.shiftKey?(this.decrementWidth(),this.$nextTick((function(){e.checkKeyboard()}))):this.keyboardLeft>0&&c.a.set(this.keyboardPosition,0,this.keyboardLeft-this.keyboardWidth));break;case"ArrowUp":this.hidden||(t.shiftKey?(this.decrementHeight(),this.$nextTick((function(){e.checkKeyboard()}))):this.keyboardTop>0&&c.a.set(this.keyboardPosition,1,this.keyboardTop-this.keyboardHeight));break;case"ArrowRight":this.hidden||(t.shiftKey?this.incrementWidth():this.keyboardLeft<this.gridWidth-this.keyboardWidth&&c.a.set(this.keyboardPosition,0,this.keyboardLeft+this.keyboardWidth));break;case"ArrowDown":this.hidden||(t.shiftKey?this.incrementHeight():this.keyboardTop<this.gridHeight-this.keyboardHeight&&c.a.set(this.keyboardPosition,1,this.keyboardTop+this.keyboardHeight));break;case"p":this.hidden=!this.hidden;break;case"Backspace":this.clearActives();break;case" ":this.nextColor();break;case"o":this.nextTheme();break;case"i":this.previousTheme();break;case"Enter":this.doExport();break;case"\\":this.doShared();break;case"=":this.tileSize;var r=new L(this.exportBuffer,this.tileSize,this.mapWidth,this.mapHeight),n=new U(this.gridWidth,this.gridHeight,r),o=this.gridWidth*this.tileSize,h=this.gridHeight*this.tileSize,d=this.$refs.base.$refs.grid,map=this.$refs.map,f=map.getContext("2d");map.width=o,map.height=h,f.fillStyle=map.style.backgroundColor,f.imageSmoothingEnabled=!1,f.webkitImageSmoothingEnabled=!1,f.mozImageSmoothingEnabled=!1,map.style.width=d.style.width,map.style.height=d.style.height;var v=!1,m=!1,y=0,k=f.createImageData(n.width*n.tilesize,n.height*n.tilesize);this.isMapActive=!0,this.isMapRunning=!0,this.mapRunner=function(){if(v){if(m){if(console.log("!!CONTRADICTION!!"),(y+=1)>10)return void(e.mapRunner=null);n.clear()}m=!n.iterate(2)}else n.graphics(k.data,null),f.putImageData(k,0,0),n.isComplete()&&(e.isMapRunning=!1);v=!v};break;case"-":this.isMapActive=!1,this.isMapRunning=!1;break;case"[":this.decreaseTileSize();break;case"]":this.increaseTileSize();break;default:if(!this.hidden){var w=Object(l.a)(X.a,["key",t.key]);w>-1&&this.toggleGrid(w)}}switch(t.key){case"!":this.toggleKeytshCollapse()}}}),created:function(){var t=this;!function e(){t.isMapRunning&&"function"==typeof t.mapRunner&&t.mapRunner(),requestAnimationFrame(e)}()},beforeMount:function(){window.addEventListener("keydown",this.keyOperation)},beforeDestroy:function(){window.removeEventListener("keydown",this.keyOperation)}},Y=r(17),component=Object(Y.a)(Q,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"wrapper",class:t.currentTheme},[r("div",{staticClass:"content"},[r("instructions"),t._v(" "),r("base-canvas",{ref:"base",attrs:{keySize:t.keySize,keyboardLeft:t.keyboardLeft,keyboardTop:t.keyboardTop,hidden:t.hidden}}),t._v(" "),r("canvas",{directives:[{name:"show",rawName:"v-show",value:t.isMapActive,expression:"isMapActive"}],ref:"map",staticClass:"map-canvas"}),t._v(" "),r("action-bar")],1)])}),[],!1,null,null,null);e.default=component.exports}}]);